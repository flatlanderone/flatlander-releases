<RamblingMan>

<!-- Rambling Man Archery -->

<!-- If RamblingManOverhaul mod not loaded -->

<conditional>
<if cond="mod_loaded('RamblingManOverhaul') == false">

<!-- *** Bows/crossbows use improvised steel, exploding and flaming arrows and bolts. -->
<csv xpath="/items/item[@name='gunBowT0PrimitiveBow' or  @name='gunBowT1WoodenBow' or @name='gunBowT3CompoundBow']/property[@class='Action0']/property[@name='Magazine_items']/@value" op="Add">ammoArrowSteelAPFTLR,ammoArrowExplodingFTLR,ammoArrowFlamingFTLR</csv>

<csv xpath="/items/item[@name='gunBowT1IronCrossbow' or @name='gunBowT3CompoundCrossbow']/property[@class='Action0']/property[@name='Magazine_items']/@value" op="Add">ammoCrossbowBoltSteelAPFTLR,ammoCrossbowBoltExplodingFTLR,ammoCrossbowBoltFlamingFTLR</csv>

<!-- *** Arrowheads -->
<!-- Recover iron and steel arrowheads from arrows and bolts. -->

<!-- Steel Arrowhead material changed to steel arrowhead. See materials.xml.-->
<setattribute xpath="/items/item[@name='resourceArrowHeadSteelAP']/property[@name='Material']" name="value">MSteelArrowPartsFTLR</setattribute>

<!-- Increased chance to find arrowheads in loot with each Archery perk rank. -->

<append xpath="/items/item[@name='resourceArrowHeadSteelAP']">
	<property name="Weight" value="1"/>
	<property name="Tags" value="parts,bowSkill"/>
</append>

<!-- Iron Arrowhead material changed to iron arrowhead. See materials.xml.-->
<setattribute xpath="/items/item[@name='resourceArrowHeadIron']/property[@name='Material']" name="value">MIronArrowPartsFTLR</setattribute>

<!-- Increased chance to find arrowheads in loot with each Archery perk rank. -->
<append xpath="/items/item[@name='resourceArrowHeadIron']">
	<property name="Weight" value="1"/>
	<property name="Tags" value="parts,bowSkill"/>
</append>

<!-- Regular Steel Arrows and Bolts scrap to steel arrowheads. Improvised Steel Arrows are handled in the item properties below. -->

<append xpath="/items/item[@name='ammoArrowSteelAP' or @name='ammoCrossbowBoltSteelAP' or @name='ammoArrowFlaming' or @name='ammoArrowExploding' or @name='ammoCrossbowBoltExploding' or @name='ammoCrossbowBoltFlaming']">
	<property name="Material" value="MSteelArrowPartsFTLR"/>
	<property name="Weight" value="1"/>
</append>

<!-- Regular Iron Arrows and Bolts scrap to iron arrowheads. Improvised Flaming and Exploding Arrows and Bolts are handled in the item properties below. -->

<setattribute xpath="/items/item[@name='ammoArrowIron' or @name='ammoCrossbowBoltIron']/property[@name='Material']" name="value">MIronArrowPartsFTLR</setattribute>

<append xpath="/items/item[@name='ammoArrowIron' or @name='ammoCrossbowBoltIron']">
	<property name="Weight" value="1"/>
</append>

<!-- *** Improvised Special Arrows -->

<append xpath="/items">

<!-- Improvised Steel Arrows -->

<item name="ammoArrowSteelAPFTLR">
	<property name="Extends" value="ammoArrowIron"/>
	<property name="DisplayType" value="ammoArrowAP"/>
	<property name="Meshfile" value="@:Other/Items/Weapons/Ranged/Bows/Arrows/arrow_steelPrefab.prefab"/>
	<property name="HoldType" value="45"/>
	<property name="HandMeshfile" value="@:Other/Items/Misc/sackPrefab.prefab"/>
	<property name="DropMeshfile" value="@:Other/Items/Misc/sack_droppedPrefab.prefab"/>
	<!-- added -->
	<property name="Material" value="MSteelArrowPartsFTLR"/>
	
	<!-- <property name="Material" value="Mmetal"/> -->
	<property name="EconomicValue" value="57"/>
	<property name="Weight" value="1"/>
	<!-- <property name="TraderStageTemplate" value="arrowsTier2"/> -->
	<!-- ammoArrowSteelAP -->
	<property name="SellableToTrader" value="false"/>
	<property name="CustomIcon" value="ammoArrowSteelAPFTLR"/>
	
	<property name="EconomicBundleSize" value="5"/>
	<property name="StickyOffset" value=".13"/>
	<property name="SoundPickup" value="arrows_grab"/>
	<property name="SoundPlace" value="arrows_place"/>
	<property name="UnlockedBy" value="perkRangersAPAmmo"/> <!-- BOOK_PERK -->

	<effect_group name="ammoArrowSteelAP" tiered="false"> <!-- ammoArrowSteelAP -->
		<passive_effect name="EntityDamage" operation="base_set" value="42" tags="perkArchery"/>
		<passive_effect name="BlockDamage" operation="base_set" value="5" tags="perkArchery"/>
	<!-- FTLR: reduce armor reduction by 10 % -->		
		<!-- <passive_effect name="TargetArmor" operation="perc_add" value="-.5"/> -->
		<!-- <display_value name="dTargetArmor" value="-.5"/> -->
		<passive_effect name="TargetArmor" operation="perc_add" value="-.4"/>
		<display_value name="dTargetArmor" value="-.4"/>
				
		<passive_effect name="DamageModifier" operation="perc_set" value=".1" tags="wood"/>
		<passive_effect name="DamageModifier" operation="perc_set" value="0" tags="earth,metal,cloth"/>
	<!-- FTLR: ProjectileVelocity reduced by 5% rounded up -->	
		<passive_effect name="ProjectileVelocity" operation="base_set" value="53" tags="perkArchery"/>
	</effect_group>
	<effect_group name="perkPenetrator" tiered="false">
		<passive_effect name="TargetArmor" operation="perc_add" value="-.1" tags="perkArchery">
			<requirement name="ProgressionLevel" progression_name="perkPenetrator" operation="Equals" value="1"/></passive_effect>
		<passive_effect name="TargetArmor" operation="perc_add" value="-.15" tags="perkArchery">
			<requirement name="ProgressionLevel" progression_name="perkPenetrator" operation="Equals" value="2"/></passive_effect>
		<passive_effect name="TargetArmor" operation="perc_add" value="-.2" tags="perkArchery">
			<requirement name="ProgressionLevel" progression_name="perkPenetrator" operation="Equals" value="3"/></passive_effect>
		<passive_effect name="TargetArmor" operation="perc_add" value="-.3" tags="perkArchery">
			<requirement name="ProgressionLevel" progression_name="perkPenetrator" operation="Equals" value="4"/></passive_effect>
	</effect_group>

	<effect_group tiered="false">
		<!-- Fully drawn bow shots bypass enemy armor, dealing full damage and deal an extra 25% damage. -->
		<triggered_effect trigger="onProjectilePreImpact" action="ModifyCVar" cvar="$perkPiercingPrecision" operation="set" value="1">
			<requirement name="ProgressionLevel" progression_name="perkAgilityMastery" operation="Equals" value="5"/>
			<requirement name="CatapultStrainAmount" operation="GTE" value="1"/>
		</triggered_effect>

		<passive_effect name="EntityDamage" operation="perc_add" value=".25" tags="perkArchery">
			<requirement name="CVarCompare" cvar="$perkPiercingPrecision" operation="EQ" value="1"/>
		</passive_effect>

		<passive_effect name="TargetArmor" operation="perc_add" value="-1" tags="perkArchery">
			<requirement name="CVarCompare" cvar="$perkPiercingPrecision" operation="EQ" value="1"/>
		</passive_effect>

		<triggered_effect trigger="onProjectileImpact" action="ModifyCVar" cvar="$perkPiercingPrecision" operation="set" value="0"/>
	</effect_group>
</item>

<!-- Improvised Steel Bolts -->
<item name="ammoCrossbowBoltSteelAPFTLR">
	<property name="Extends" value="ammoCrossbowBoltIron"/>
	<property name="DisplayType" value="ammoArrowAP"/>
	<property name="Meshfile" value="@:Other/Items/Weapons/Ranged/Bows/Arrows/bolt_steelPrefab.prefab"/>
	<property name="HoldType" value="45"/>
	<property name="HandMeshfile" value="@:Other/Items/Misc/sackPrefab.prefab"/>
	<property name="DropMeshfile" value="@:Other/Items/Misc/sack_droppedPrefab.prefab"/>
	<!-- added -->
	<property name="Material" value="MSteelArrowPartsFTLR"/>
	<!-- <property name="Material" value="Mmetal"/> -->
	<property name="Weight" value="1"/>
	<property name="UnlockedBy" value="perkRangersAPAmmo"/> <!-- BOOK_PERK -->
	<property name="EconomicValue" value="57"/>
	<!-- <property name="TraderStageTemplate" value="arrowsTier2"/> -->
	<!-- ammoCrossbowBoltSteelAP -->
	<property name="SellableToTrader" value="false"/>
	<property name="CustomIcon" value="ammoCrossbowBoltSteelAPFTLR"/>	
	<property name="EconomicBundleSize" value="5"/>
	<property name="IsSticky" value="true"/>
	<property name="StickyOffset" value=".13"/>
	<property name="StickyColliderUp" value="2"/>
	<property name="StickyColliderRadius" value=".05"/>
	<property name="StickyColliderLength" value=".75"/>
	
	<effect_group name="ammoCrossbowBoltSteelAP" tiered="false"> <!-- ammoCrossbowBoltSteelAP -->
		<passive_effect name="EntityDamage" operation="base_set" value="63" tags="perkArchery"/>
		<passive_effect name="BlockDamage" operation="base_set" value="6" tags="perkArchery"/>
	<!-- FTLR: reduce armor reduction by 10 % -->
		<!-- <passive_effect name="TargetArmor" operation="perc_add" value="-.5"/> -->
		<!-- <display_value name="dTargetArmor" value="-.5"/> -->
		<passive_effect name="TargetArmor" operation="perc_add" value="-.4"/>
		<display_value name="dTargetArmor" value="-.4"/>
		<passive_effect name="BlockDamage" operation="perc_set" value=".1" tags="wood"/>
		<passive_effect name="BlockDamage" operation="perc_set" value="0" tags="earth,metal,cloth"/>
<!-- FTLR: ProjectileVelocity reduced by 5% rounded up -->			
		<passive_effect name="ProjectileVelocity" operation="base_set" value="79" tags="perkArchery"/>
		<!-- <passive_effect name="ProjectileVelocity" operation="base_set" value="82.5" tags="perkArchery"/> -->
	</effect_group>
	<effect_group name="perkPenetrator" tiered="false">
		<passive_effect name="TargetArmor" operation="perc_add" value="-.1" tags="perkArchery">
			<requirement name="ProgressionLevel" progression_name="perkPenetrator" operation="Equals" value="1"/></passive_effect>
		<passive_effect name="TargetArmor" operation="perc_add" value="-.15" tags="perkArchery">
			<requirement name="ProgressionLevel" progression_name="perkPenetrator" operation="Equals" value="2"/></passive_effect>
		<passive_effect name="TargetArmor" operation="perc_add" value="-.2" tags="perkArchery">
			<requirement name="ProgressionLevel" progression_name="perkPenetrator" operation="Equals" value="3"/></passive_effect>
		<passive_effect name="TargetArmor" operation="perc_add" value="-.3" tags="perkArchery">
			<requirement name="ProgressionLevel" progression_name="perkPenetrator" operation="Equals" value="4"/></passive_effect>
	</effect_group>
</item>

<!-- Improvised Exploding Arrows -->

<item name="ammoArrowExplodingFTLR">
	<property name="Extends" value="ammoArrowIron"/>
	<property name="Tags" value="ammo,ranged,attAgility,perkArchery,perkPenetrator,perkDemolitionsExpert"/> <!-- Add DemolitionsExpert to affect explosion power -->
	<property name="DescriptionKey" value="ammoArrowExplodingFTLRDesc"/>
	<property name="DisplayType" value="ammoArrowExploding"/>
	<property name="Meshfile" value="@:Other/Items/Weapons/Ranged/Bows/Arrows/arrow_explodingPrefab.prefab"/>
	<property name="HoldType" value="45"/>
	<property name="HandMeshfile" value="@:Other/Items/Misc/sackPrefab.prefab"/>
	<property name="DropMeshfile" value="@:Other/Items/Misc/sack_droppedPrefab.prefab"/>
	<property name="IsSticky" value="false"/>
	<property name="Stacknumber" value="75"/>
	<property name="EconomicValue" value="65"/>
	<property name="Material" value="MIronArrowPartsFTLR"/>
	<property name="Weight" value="1"/>
	<!-- <property name="TraderStageTemplate" value="arrowsTier4"/> -->
	<!-- ammoArrowExploding -->
	<property name="SellableToTrader" value="false"/>
	<property name="CustomIcon" value="ammoArrowExplodingFTLR"/>
	<!-- <property name="CustomIconTint" value="ffb0b0"/>	 -->
	<property name="EconomicBundleSize" value="1"/>
	<property name="UsableUnderwater" value="false"/>
	<property name="SoundPickup" value="arrows_grab"/>
	<property name="SoundPlace" value="arrows_place"/>
	<property name="UnlockedBy" value="perkRangersExplodingBolts"/> <!-- BOOK_PERK -->
	
	<property class="Action1">
		<!--<property name="Explosion.ParticleIndex" value="0"/> no expl. -->
		<property name="Gravity" value="-5"/>
		<property name="Explosion.BlockDamage" value="80"/>
		<property name="Explosion.EntityDamage" value="180"/>
		<property name="Explosion.ParticleIndex" value="11"/>
		<property name="Explosion.RadiusBlocks" value="3"/>
		<property name="Explosion.RadiusEntities" value="4"/>
		<property name="Explosion.DamageBonus.stone" value=".3"/>
		<property name="Explosion.DamageBonus.metal" value=".1"/>
		<property name="Explosion.DamageBonus.earth" value="0"/> <!-- should work? -->
		<property name="Explosion.DamageBonus.wood" value=".5"/>
		<property name="Explosion.DamageBonus.water" value="0"/>
	</property>
	<effect_group name="ammoArrowExploding" tiered="false"> <!-- ammoArrowExploding -->
		<passive_effect name="BlockDamage" operation="base_set" value="2" tags="perkArchery"/> <!-- Only affects direct hit damage, explosion damage is above -->
		<passive_effect name="BlockDamage" operation="base_add" value="50" tags="barrelExplosive"/>
		<passive_effect name="EntityDamage" operation="base_set" value="180" tags="perkArchery"/>
		<passive_effect name="DamageModifier" operation="perc_add" value="-.5" tags="wood"/>
		<passive_effect name="DamageModifier" operation="perc_set" value=".1" tags="wood"/>
		<passive_effect name="DamageModifier" operation="perc_set" value="0" tags="earth,water"/>
			<!-- do we have damage modifiers for explosions? -->
		<passive_effect name="ProjectileVelocity" operation="base_set" value="40" tags="perkArchery"/>
		<passive_effect name="ProjectileStickChance" operation="perc_set" value="0"/>
		<display_value name="dExRadius" value="4"/>
		<display_value name="dExBlockDamage" value="80"/>
		<display_value name="dExEntityDamage" value="180"/>
	</effect_group>

	<effect_group name="ammoArrowExplodingFuse" tiered="false">
		<triggered_effect trigger="onSelfEquipStart" action="AttachParticleEffectToEntity" particle="p_sparks_fuse" parent_transform="Fuse6">
			<requirement name="CVarCompare" cvar="_underwater" operation="LT" value="1"/>
		</triggered_effect>
		<triggered_effect trigger="onSelfEquipStop" action="RemoveParticleEffectFromEntity" particle="p_sparks_fuse"/>
		<triggered_effect trigger="onSelfWaterSurface" action="AttachParticleEffectToEntity" particle="p_sparks_fuse" parent_transform="Fuse6"/>
		<triggered_effect trigger="onSelfWaterSubmerge" action="RemoveParticleEffectFromEntity" particle="p_sparks_fuse"/>
		<triggered_effect trigger="onReloadStop" action="AttachParticleEffectToEntity" particle="p_sparks_fuse" parent_transform="Fuse6">
			<requirement name="CVarCompare" cvar="_underwater" operation="LT" value="1"/>
		</triggered_effect>
	</effect_group>

	<effect_group tiered="false">
		<!-- Fully drawn bow shots bypass enemy armor, dealing full damage and deal an extra 25% damage. -->
		<triggered_effect trigger="onProjectilePreImpact" action="ModifyCVar" cvar="$perkPiercingPrecision" operation="set" value="1">
			<requirement name="ProgressionLevel" progression_name="perkAgilityMastery" operation="Equals" value="5"/>
			<requirement name="CatapultStrainAmount" operation="GTE" value="1"/>
		</triggered_effect>

		<passive_effect name="EntityDamage" operation="perc_add" value=".25" tags="perkArchery">
			<requirement name="CVarCompare" cvar="$perkPiercingPrecision" operation="EQ" value="1"/>
		</passive_effect>

		<passive_effect name="TargetArmor" operation="perc_add" value="-1" tags="perkArchery">
			<requirement name="CVarCompare" cvar="$perkPiercingPrecision" operation="EQ" value="1"/>
		</passive_effect>

		<triggered_effect trigger="onProjectileImpact" action="ModifyCVar" cvar="$perkPiercingPrecision" operation="set" value="0"/>
	</effect_group>
<!-- add random damage -30% to +30% -->
	<effect_group tiered="false">
		<passive_effect name="ExplosionEntityDamage" operation="perc_add" value="-.3,.3" /> 
		<!-- random EntityDmg -->
		<passive_effect name="ExplosionBlockDamage" operation="perc_add" value="-.3,.3" /> 
		<!-- random BlockDmg -->
	</effect_group>	

</item>

<!-- Improvised Exploding Bolts  -->
<item name="ammoCrossbowBoltExplodingFTLR">
	<property name="Extends" value="ammoCrossbowBoltIron"/>
	<property name="Tags" value="ammo,ranged,attAgility,perkArchery,perkPenetrator,perkDemolitionsExpert"/>
	<property name="DescriptionKey" value="ammoCrossbowBoltExplodingFTLRDesc"/>
	<property name="Tags" value="ammo,ranged,attAgility,perkArchery"/>
	<property name="DisplayType" value="ammoArrowExploding"/>
	<property name="Meshfile" value="@:Other/Items/Weapons/Ranged/Bows/Arrows/bolt_explodingPrefab.prefab"/>
	<property name="HoldType" value="45"/>
	<property name="HandMeshfile" value="@:Other/Items/Misc/sackPrefab.prefab"/>
	<property name="DropMeshfile" value="@:Other/Items/Misc/sack_droppedPrefab.prefab"/>
	<property name="IsSticky" value="false"/>
	<property name="Stacknumber" value="75"/>
	<property name="EconomicValue" value="80"/>
	<property name="Material" value="MIronArrowPartsFTLR"/>
	<property name="Weight" value="1"/>
	
	<!-- <property name="TraderStageTemplate" value="arrowsTier4"/> -->
	<!-- ammoCrossbowBoltExploding -->
	<property name="SellableToTrader" value="false"/>
	<property name="CustomIcon" value="ammoCrossbowBoltExplodingFTLR"/>
	<!-- <property name="CustomIconTint" value="ffb0b0"/> -->
	<property name="EconomicBundleSize" value="1"/>	
	<property name="UsableUnderwater" value="false"/>
	<property name="UnlockedBy" value="perkRangersExplodingBolts"/> <!-- BOOK_PERK -->
	
	<property class="Action1">
		<!--<property name="Explosion.ParticleIndex" value="0"/> no expl. -->
		<property name="Gravity" value="-5"/>
		<property name="Explosion.BlockDamage" value="60"/>
		<property name="Explosion.EntityDamage" value="180"/>
		<property name="Explosion.ParticleIndex" value="11"/>
		<property name="Explosion.RadiusBlocks" value="3"/>
		<property name="Explosion.RadiusEntities" value="4"/>
		<property name="Explosion.DamageBonus.stone" value=".3"/>
		<property name="Explosion.DamageBonus.metal" value=".1"/>
		<property name="Explosion.DamageBonus.earth" value="0"/> <!-- should work? -->
		<property name="Explosion.DamageBonus.wood" value=".5"/>
		<property name="Explosion.DamageBonus.water" value="0"/>
	</property>
	<effect_group name="ammoCrossbowBoltExploding" tiered="false"> <!-- ammoCrossbowBoltExploding -->
		<passive_effect name="BlockDamage" operation="base_set" value="2" tags="perkArchery"/>
		<passive_effect name="BlockDamage" operation="base_add" value="50" tags="barrelExplosive"/>
		<passive_effect name="EntityDamage" operation="base_set" value="250" tags="perkArchery"/>
		<passive_effect name="DamageModifier" operation="perc_add" value="-.5" tags="wood"/>
		<passive_effect name="DamageModifier" operation="perc_set" value=".1" tags="wood"/>
		<passive_effect name="DamageModifier" operation="perc_set" value="0" tags="earth,water"/>
			<!-- do we have damage modifiers for explosions? -->
		<passive_effect name="ProjectileVelocity" operation="base_set" value="45" tags="perkArchery"/>
		<passive_effect name="ProjectileStickChance" operation="perc_set" value="0"/>
		<display_value name="dExRadius" value="4"/>
		<display_value name="dExBlockDamage" value="60"/>
		<display_value name="dExEntityDamage" value="180"/>
	</effect_group>

	<effect_group name="ammoCrossbowBoltExplodingFuse" tiered="false">
		<triggered_effect trigger="onSelfEquipStart" action="AttachParticleEffectToEntity" particle="p_sparks_fuse" parent_transform="Fuse6">
			<requirement name="CVarCompare" cvar="_underwater" operation="LT" value="1"/>
		</triggered_effect>
		<triggered_effect trigger="onSelfEquipStop" action="RemoveParticleEffectFromEntity" particle="p_sparks_fuse"/>
		<triggered_effect trigger="onSelfWaterSurface" action="AttachParticleEffectToEntity" particle="p_sparks_fuse" parent_transform="Fuse6"/>
		<triggered_effect trigger="onSelfWaterSubmerge" action="RemoveParticleEffectFromEntity" particle="p_sparks_fuse"/>
		<triggered_effect trigger="onReloadStop" action="AttachParticleEffectToEntity" particle="p_sparks_fuse" parent_transform="Fuse6">
			<requirement name="CVarCompare" cvar="_underwater" operation="LT" value="1"/>
		</triggered_effect>
	</effect_group>
<!-- add random damage -->
	<effect_group tiered="false">
		<passive_effect name="ExplosionEntityDamage" operation="perc_add" value="-.3,.3" /> 
		<!-- random EntityDmg -->
		<passive_effect name="ExplosionBlockDamage" operation="perc_add" value="-.3,.3" /> 
		<!-- random BlockDmg -->
	</effect_group>	
</item>

<!-- Improvised Flaming Arrows  -->
<item name="ammoArrowFlamingFTLR">
	<property name="Extends" value="ammoArrowIron"/>
	<property name="DisplayType" value="ammoArrowFlaming"/>
	<property name="Meshfile" value="@:Other/Items/Weapons/Ranged/Bows/Arrows/arrow_flamingPrefab.prefab"/>
	<property name="HoldType" value="45"/>
	<property name="HandMeshfile" value="@:Other/Items/Misc/sackPrefab.prefab"/>
	<property name="DropMeshfile" value="@:Other/Items/Misc/sack_droppedPrefab.prefab"/>
	<property name="IsSticky" value="false"/>
	<property name="UsableUnderwater" value="false"/>
	<property name="EconomicValue" value="44"/>
	
	<property name="Material" value="MIronArrowPartsFTLR"/>
	<property name="Weight" value="1"/>
	<!-- <property name="TraderStageTemplate" value="arrowsTier3"/> -->
	<!-- ammoArrowFlaming --> -->
	<property name="SellableToTrader" value="false"/>
	<property name="CustomIcon" value="ammoArrowFlamingFTLR"/>
	<property name="EconomicBundleSize" value="1"/>
	<property name="Damage_type" value="Heat"/>
	<property name="StickyOffset" value=".7"/>
	<property name="SoundPickup" value="arrows_grab"/>
	<property name="SoundPlace" value="arrows_place"/>
	<property name="UnlockedBy" value="perkRangersFlamingArrows"/> <!-- BOOK_PERK -->
	
	<property class="Action1">
		<property name="Gravity" value="-5"/>
		<property name="DamageBonus.wood" value="2"/>
	</property>
	<effect_group name="ammoArrowFlaming" tiered="false"> <!-- ammoArrowFlaming -->
		<passive_effect name="EntityDamage" operation="base_set" value="25" tags="perkArchery"/>
		<passive_effect name="BlockDamage" operation="base_set" value="6" tags="perkArchery"/>
		<passive_effect name="BlockDamage" operation="base_add" value="50" tags="barrelExplosive"/>
		<passive_effect name="DamageModifier" operation="perc_set" value=".1" tags="wood"/>
		<passive_effect name="DamageModifier" operation="perc_set" value="0" tags="earth,cloth"/>
		<passive_effect name="ProjectileVelocity" operation="base_set" value="40" tags="perkArchery"/>
		<passive_effect name="ProjectileStickChance" operation="perc_set" value="0"/>

		<triggered_effect trigger="onProjectileImpact" action="ModifyCVar" target="other" cvar="$buffBurningFlamingArrowDuration" operation="set" value="14">
			<requirement name="ProgressionLevel" progression_name="perkFiremansAlmanacMolotov" operation="Equals" value="0"/></triggered_effect>
		<triggered_effect trigger="onProjectileImpact" action="ModifyCVar" target="other" cvar="$buffBurningFlamingArrowDuration" operation="set" value="16">
			<requirement name="ProgressionLevel" progression_name="perkFiremansAlmanacMolotov" operation="Equals" value="1"/></triggered_effect>

		<triggered_effect trigger="onProjectileImpact" action="AddBuff" target="other" buff="buffBurningFlamingArrow">
			<requirement name="CVarCompare" target="other" cvar="_underwater" operation="LT" value="0.3"/>
		</triggered_effect>

		<display_value name="dEntityDamageFire" value="120"/>
		<display_value name="dDuration" value="14"/>
	</effect_group>

	<effect_group name="ammoArrowFlamingFire" tiered="false">
		<triggered_effect trigger="onSelfEquipStart" action="AttachParticleEffectToEntity" particle="p_fire_flaming_arrow" parent_transform="particle_joint">
			<requirement name="CVarCompare" cvar="_underwater" operation="LT" value="1"/>
		</triggered_effect>
		<triggered_effect trigger="onSelfEquipStop" action="RemoveParticleEffectFromEntity" particle="p_fire_flaming_arrow"/>
		<triggered_effect trigger="onSelfWaterSurface" action="AttachParticleEffectToEntity" particle="p_fire_flaming_arrow" parent_transform="particle_joint"/>
		<triggered_effect trigger="onSelfWaterSubmerge" action="RemoveParticleEffectFromEntity" particle="p_fire_flaming_arrow"/>
		<triggered_effect trigger="onReloadStart" action="AttachParticleEffectToEntity" particle="p_fire_flaming_arrow" parent_transform="particle_joint">
			<requirement name="CVarCompare" cvar="_underwater" operation="LT" value="1"/>
		</triggered_effect>

		<triggered_effect trigger="onSelfEquipStart" action="AttachParticleEffectToEntity" particle="p_fire_arrow_flaming_cloth" parent_transform="Cloth_4">
			<requirement name="CVarCompare" cvar="_underwater" operation="LT" value="1"/>
		</triggered_effect>
		<triggered_effect trigger="onSelfEquipStop" action="RemoveParticleEffectFromEntity" particle="p_fire_arrow_flaming_cloth"/>
		<triggered_effect trigger="onSelfWaterSurface" action="AttachParticleEffectToEntity" particle="p_fire_arrow_flaming_cloth" parent_transform="Cloth_4"/>
		<triggered_effect trigger="onSelfWaterSubmerge" action="RemoveParticleEffectFromEntity" particle="p_fire_arrow_flaming_cloth"/>
		<triggered_effect trigger="onReloadStart" action="AttachParticleEffectToEntity" particle="p_fire_arrow_flaming_cloth" parent_transform="Cloth_4">
			<requirement name="CVarCompare" cvar="_underwater" operation="LT" value="1"/>
		</triggered_effect>
	</effect_group>

	<effect_group tiered="false">
		<!-- Fully drawn bow shots bypass enemy armor, dealing full damage and deal an extra 25% damage. -->
		<triggered_effect trigger="onProjectilePreImpact" action="ModifyCVar" cvar="$perkPiercingPrecision" operation="set" value="1">
			<requirement name="ProgressionLevel" progression_name="perkAgilityMastery" operation="Equals" value="5"/>
			<requirement name="CatapultStrainAmount" operation="GTE" value="1"/>
		</triggered_effect>

		<passive_effect name="EntityDamage" operation="perc_add" value=".25" tags="perkArchery">
			<requirement name="CVarCompare" cvar="$perkPiercingPrecision" operation="EQ" value="1"/>
		</passive_effect>

		<passive_effect name="TargetArmor" operation="perc_add" value="-1" tags="perkArchery">
			<requirement name="CVarCompare" cvar="$perkPiercingPrecision" operation="EQ" value="1"/>
		</passive_effect>

		<triggered_effect trigger="onProjectileImpact" action="ModifyCVar" cvar="$perkPiercingPrecision" operation="set" value="0"/>
	</effect_group>
</item>

<!-- Improvised Flaming Bolts  -->
<item name="ammoCrossbowBoltFlamingFTLR">
	<property name="Extends" value="ammoCrossbowBoltIron"/>
	<property name="DisplayType" value="ammoArrowFlaming"/>
	<property name="Meshfile" value="@:Other/Items/Weapons/Ranged/Bows/Arrows/bolt_flamingPrefab.prefab"/>
	<property name="HoldType" value="45"/>
	<property name="HandMeshfile" value="@:Other/Items/Misc/sackPrefab.prefab"/>
	<property name="DropMeshfile" value="@:Other/Items/Misc/sack_droppedPrefab.prefab"/>
	<property name="IsSticky" value="false"/>
	<property name="UsableUnderwater" value="false"/>
	<property name="EconomicValue" value="44"/>
	<property name="Material" value="MIronArrowPartsFTLR"/>
	<property name="Weight" value="1"/>
 
	<!-- <property name="TraderStageTemplate" value="arrowsTier3"/> -->
	<!-- ammoCrossbowBoltFlaming -->
	<property name="SellableToTrader" value="false"/>
	<property name="CustomIcon" value="ammoCrossbowBoltFlamingFTLR"/>	
	<property name="EconomicBundleSize" value="1"/>
	<property name="Damage_type" value="Heat"/>
	<property name="StickyOffset" value=".7"/>
	<property name="UnlockedBy" value="perkRangersFlamingArrows"/> <!-- BOOK_PERK -->
	
	<property class="Action1">
		<property name="Gravity" value="-5"/>
		<property name="DamageBonus.wood" value="2"/>
	</property>
	<effect_group name="ammoCrossbowBoltFlaming" tiered="false"> <!-- ammoCrossbowBoltFlaming -->
		<passive_effect name="EntityDamage" operation="base_set" value="38" tags="perkArchery"/>
		<passive_effect name="BlockDamage" operation="base_set" value="6" tags="perkArchery"/>
		<passive_effect name="BlockDamage" operation="base_add" value="50" tags="barrelExplosive"/>
		<passive_effect name="DamageModifier" operation="perc_set" value=".1" tags="wood"/>
		<passive_effect name="DamageModifier" operation="perc_set" value="0" tags="earth,cloth"/>
		<passive_effect name="ProjectileVelocity" operation="base_set" value="50" tags="perkArchery"/>
		<passive_effect name="ProjectileStickChance" operation="perc_set" value="0"/>

		<triggered_effect trigger="onProjectileImpact" action="ModifyCVar" target="other" cvar="$buffBurningFlamingArrowDuration" operation="set" value="14">
			<requirement name="ProgressionLevel" progression_name="perkFiremansAlmanacMolotov" operation="Equals" value="0"/></triggered_effect>
		<triggered_effect trigger="onProjectileImpact" action="ModifyCVar" target="other" cvar="$buffBurningFlamingArrowDuration" operation="set" value="16">
			<requirement name="ProgressionLevel" progression_name="perkFiremansAlmanacMolotov" operation="Equals" value="1"/></triggered_effect>

		<triggered_effect trigger="onProjectileImpact" action="AddBuff" target="other" buff="buffBurningFlamingArrow">
			<requirement name="CVarCompare" target="other" cvar="_underwater" operation="LT" value="0.3"/>
		</triggered_effect>

		<display_value name="dEntityDamageFire" value="120"/>
		<display_value name="dDuration" value="14"/>
	</effect_group>

	<effect_group name="ammoCrossbowBoltFlamingFuse" tiered="false">
		<triggered_effect trigger="onSelfEquipStart" action="AttachParticleEffectToEntity" particle="p_fire_flaming_arrow" parent_transform="particle_joint">
			<requirement name="CVarCompare" cvar="_underwater" operation="LT" value="1"/>
		</triggered_effect>
		<triggered_effect trigger="onSelfEquipStop" action="RemoveParticleEffectFromEntity" particle="p_fire_flaming_arrow"/>
		<triggered_effect trigger="onSelfWaterSurface" action="AttachParticleEffectToEntity" particle="p_fire_flaming_arrow" parent_transform="particle_joint"/>
		<triggered_effect trigger="onSelfWaterSubmerge" action="RemoveParticleEffectFromEntity" particle="p_fire_flaming_arrow"/>
		<triggered_effect trigger="onReloadStart" action="AttachParticleEffectToEntity" particle="p_fire_flaming_arrow" parent_transform="particle_joint">
			<requirement name="CVarCompare" cvar="_underwater" operation="LT" value="1"/>
		</triggered_effect>
	</effect_group>
</item>

<!-- *** Improvised Thrown Explosives -->
<!-- Add improvised pipe bombs, timed charges, dynamite. -->

<item name="thrownAmmoPipeBombFTLR">
	<property name="Tags" value="ammo,weapon,attPerception,perkDemolitionsExpert,explosivesSkill"/>
	<property name="DescriptionKey" value="thrownAmmoPipeBombFTLRDesc"/>
	<property name="ItemTypeIcon" value="explosion"/>
	<property name="DisplayType" value="ammoGrenade"/>
	<property name="Class" value="ItemClassTimeBomb"/>
	<property name="HoldType" value="25"/>
	<property name="Meshfile" value="@:Other/Items/Weapons/Ranged/PipeBomb/PipeBombPrefab.prefab"/>
	<property name="DropScale" value="2.5"/>
	<property name="Material" value="Mmetal"/>
	<property name="Stacknumber" value="20"/>
	<property name="EconomicValue" value="50"/>
	<!-- <property name="TraderStageTemplate" value="baseTier1"/> -->
	<!-- thrownAmmoPipeBomb -->
	<property name="SellableToTrader" value="false"/>
	<property name="CustomIcon" value="thrownAmmoPipeBombFTLR"/>
	<!-- <property name="CustomIconTint" value="ffb0b0"/> -->
	<property name="Weight" value="0"/>
	<property name="Explosion.BlockDamage" value="5"/>
	<property name="Explosion.EntityDamage" value="253"/>
	<property name="Explosion.ParticleIndex" value="20"/>
	<property name="Explosion.RadiusBlocks" value="4"/>
	<property name="Explosion.RadiusEntities" value="4"/>
	<property name="Explosion.DamageBonus.earth" value="0"/> <!-- should work? -->
	<property name="Explosion.DamageBonus.water" value="0"/>
	<property name="Explosion.BlastPower" value="75"/> <!-- (int,100) how far ragdolls and such are flung -->
	<property name="FuseTime" value="4"/> <!-- End: Needed for time in sec, max 6 -->
	<property name="StickPercent" value=".4"/>
	<property name="UnlockedBy" value="craftingExplosives"/>
	<!-- perkDemolitionsExpert,thrownAmmoPipeBombSchematic, -->
	<property name="Group" value="Ammo/Weapons,Ammo"/>
	<property name="ActivationTransformToHide" value="Sparks"/>
	<property name="SoundPickup" value="pipebomb_grab"/>
	<property name="SoundPlace" value="pipebomb_place"/>
	<property class="Action0">
		<property name="Class" value="ThrowAway"/>
		<!-- <property name="Hitmask_override" value="Arrow"/> unfortunately this cannot work without a serious rewrite of the hitmask system -->
		<property name="Delay" value="1.2"/> <!-- obsolete if rounds per minute exists -->
		<property name="Throw_strength_default" value="8"/>
		<property name="Throw_strength_max" value="50"/>
		<property name="Max_strain_time" value="1.25"/>
		<property name="Sound_start" value="swoosh"/>
		<property name="triggerEffectTriggerPullDualsense" value="ShotgunTrigger"/>
		<property name="triggerEffectTriggerPullXbox" value="ShotgunTrigger"/>
		<property name="triggerEffectShootDualsense" value="ShotgunShoot"/>
		<property name="triggerEffectShootXbox" value="PistolShoot"/>
	</property>
	<property class="Action1"> <!-- UseAction -->
		<property name="Class" value="Activate"/>
		<requirement name="CVarCompare" cvar="_underwater" operation="LT" value="1"/>
		<property name="Delay" value="1"/> <!-- obsolete if rounds per minute exists -->
	</property>
	<property name="ThrowableDecoy" value="true"/>
	<effect_group tiered="false">
		<display_value name="dExRadius" value="1.5"/>
		<display_value name="dExBlockDamage" value="5"/>
		<display_value name="dExEntityDamage" value="253"/>
		<display_value name="dFuseTime" value="4"/>
		<triggered_effect trigger="onSelfWaterSubmerge" action="ResetHeldItem"/>
	</effect_group>
<!-- add random damage -->
	<effect_group tiered="false">
		<passive_effect name="ExplosionEntityDamage" operation="perc_add" value="-.3,.3" /> 
		<!-- random EntityDmg -->
		<passive_effect name="ExplosionBlockDamage" operation="perc_add" value="-.3,.3" /> 
		<!-- random BlockDmg -->
	</effect_group>		
</item>

<item name="thrownTimedChargeFTLR">
	<property name="Tags" value="ammo,weapon,attPerception,perkDemolitionsExpert,explosivesSkill,perkGreatHeistSafes"/>
	<property name="DescriptionKey" value="thrownTimedChargeFTLRDesc"/>	
	<property name="ItemTypeIcon" value="explosion"/>
	<property name="DisplayType" value="ammoGrenadeTimedCharge"/>
	<property name="Class" value="ItemClassTimeBomb"/>
	<property name="HoldType" value="62"/>
	<property name="Meshfile" value="@:Other/Items/Weapons/Ranged/TimedCharge/timedChargePrefab.prefab"/>
	<property name="ActivationTransformToHide" value="Armed"/>
	<property name="DropScale" value="1.8"/>
	<property name="Material" value="Mmetal"/>
	<property name="Stacknumber" value="10"/>
	<property name="EconomicValue" value="300"/>
	<property name="CustomIcon" value="thrownTimedChargeFTLR"/>
	<!-- <property name="CustomIconTint" value="ffb0b0"/> -->
	<!-- <property name="TraderStageTemplate" value="baseTier2"/> -->
	<!-- thrownTimedCharge -->
	<property name="SellableToTrader" value="false"/>
	<property name="Weight" value="0"/>
	<property name="Explosion.BlockDamage" value="110"/>
	<property name="Explosion.EntityDamage" value="800"/>
	<property name="Explosion.BlockTags" value="door,safes,timecharge"/>
	<property name="Explosion.DamageBonus.tags" value="38"/>
	<property name="Explosion.ParticleIndex" value="21"/>
	<property name="Explosion.RadiusBlocks" value=".65"/>
	<property name="Explosion.RadiusEntities" value="1.2"/>
	<property name="Explosion.DamageBonus.stone" value="1"/>
	<property name="Explosion.DamageBonus.metal" value="1"/>
	<property name="Explosion.DamageBonus.earth" value="1"/> <!-- should work? -->
	<property name="Explosion.DamageBonus.wood" value="1"/>
	<property name="Explosion.DamageBonus.water" value="0"/>
	<property name="Explosion.BlastPower" value="75"/> <!-- (int,100) how far ragdolls and such are flung -->
	<property name="FusePrimeOnActivate" value="true"/>
	<property name="FuseTime" value="4"/> <!-- End: Needed for time in sec, max 6 -->
	<property name="StickPercent" value="1"/>
	<property name="UnlockedBy" value="craftingExplosives"/>
	<!-- perkDemolitionsExpert,bookGreatHeistGoldRush, -->
	<property name="Group" value="Ammo/Weapons,Ammo"/>
	<property name="SoundUnholster" value="charge_unholster"/>
	<property name="SoundStick" value="charge_stick"/>
	<property name="SoundTick" value="charge_beep,.8"/>
	<property name="SoundPickup" value="timedcharge_grab"/>
	<property name="SoundPlace" value="timedcharge_place"/>
	<property class="Action0">
		<property name="Class" value="ThrowAway"/>
		<property name="Delay" value="1.2"/>
		<property name="Throw_strength_default" value="15"/>
		<property name="Max_strain_time" value="0"/>
		<property name="Sound_start" value="charge_throw"/>
		<property name="triggerEffectTriggerPullDualsense" value="ShotgunTrigger"/>
		<property name="triggerEffectTriggerPullXbox" value="ShotgunTrigger"/>
		<property name="triggerEffectShootDualsense" value="ShotgunShoot"/>
		<property name="triggerEffectShootXbox" value="PistolShoot"/>
	</property>
	<property class="Action1">
		<!-- UseAction -->
		<property name="Class" value="Activate"/>
		<property name="Delay" value="1"/>
		<!-- obsolete if rounds per minute exists -->
		<requirement name="CVarCompare" cvar="_underwater" operation="LT" value="1"/>
	</property>
	<property name="ThrowableDecoy" value="true"/>
	<effect_group tiered="false">
		<display_value name="dExRadius" value="1"/>
		<display_value name="dExBlockDamage" value="3000"/>
		<display_value name="dExEntityDamage" value="800"/>
		<display_value name="dFuseTime" value="4"/>
	</effect_group>
<!-- add random damage -->
	<effect_group tiered="false">
		<passive_effect name="ExplosionEntityDamage" operation="perc_add" value="-.3,.3" /> 
		<!-- random EntityDmg -->
		<passive_effect name="ExplosionBlockDamage" operation="perc_add" value="-.3,.3" /> 
		<!-- random BlockDmg -->
	</effect_group>	
</item>

<item name="thrownDynamiteFTLR">
	<property name="Tags" value="ammo,weapon,attPerception,perkDemolitionsExpert,explosivesSkill"/>
	<property name="DescriptionKey" value="thrownDynamiteFTLRDesc"/>	
	<property name="ItemTypeIcon" value="explosion"/>
	<property name="DisplayType" value="ammoGrenade"/>
	<property name="Class" value="ItemClassTimeBomb"/>
	<property name="HoldType" value="66"/>
	<property name="Meshfile" value="@:Other/Items/Weapons/Ranged/Dynamite/dynamitePrefab.prefab"/>
	<property name="DropScale" value="2.5"/>
	<property name="Material" value="MDynamite"/>
	<property name="Stacknumber" value="10"/>
	<property name="EconomicValue" value="100"/>
	<property name="CustomIcon" value="thrownDynamiteFTLR"/>
	<!-- <property name="CustomIconTint" value="ffb0b0"/>	 -->
	<!-- <property name="TraderStageTemplate" value="baseTier2"/> -->
	<!-- thrownDynamite -->
	<property name="SellableToTrader" value="false"/>
	<property name="Weight" value="0"/>
	<property name="ActivationTransformToHide" value="Sparks"/>
	<property name="Explosion.BlockDamage" value="3000"/>
	<property name="Explosion.EntityDamage" value="550"/>
	<property name="Explosion.ParticleIndex" value="22"/>
	<property name="Explosion.RadiusBlocks" value="5"/>
	<property name="Explosion.RadiusEntities" value="6"/>
	<!--<property name="Explosion.DamageBonus.stone" value="0"/><property name="Explosion.DamageBonus.metal" value="0"/><property name="Explosion.DamageBonus.earth" value="0"/><property name="Explosion.DamageBonus.cloth" value="5"/><property name="Explosion.DamageBonus.wood" value="0"/><property name="Explosion.DamageBonus.water" value="0"/>-->
	<property name="FuseTime" value="4"/> <!-- End: Needed for time in sec, max 6 -->
	<property name="StickPercent" value=".2"/>
	<property name="UnlockedBy" value="craftingExplosives"/>
	<!-- perkDemolitionsExpert,thrownDynamiteSchematic, -->
	<property name="Group" value="Ammo/Weapons,Ammo"/>
	<property name="SoundPickup" value="dynamite_grab"/>
	<property name="SoundPlace" value="dynamite_place"/>
	<property class="Action0">
		<property name="Class" value="ThrowAway"/>
		<property name="Delay" value="1.2"/> <!-- obsolete if rounds per minute exists -->
		<property name="Throw_strength_default" value="6"/>
		<property name="Throw_strength_max" value="28"/>
		<property name="Max_strain_time" value="1.25"/>
		<property name="Sound_start" value="swoosh"/>
		<property name="triggerEffectTriggerPullDualsense" value="RifleTrigger"/>
		<property name="triggerEffectTriggerPullXbox" value="PistolTrigger"/>
		<property name="triggerEffectTriggerShootDualsense" value="MGShoot"/>
		<property name="triggerEffectTriggerShootXbox" value="PistolShoot"/>
	</property>
	<property class="Action1"> <!-- UseAction -->
		<property name="Class" value="Activate"/>
		<requirement name="CVarCompare" cvar="_underwater" operation="LT" value="1"/>
		<property name="Delay" value="1"/> <!-- obsolete if rounds per minute exists -->
	</property>
	<property name="ThrowableDecoy" value="true"/>
	<effect_group tiered="false">
		<display_value name="dExRadius" value="1.5"/>
		<display_value name="dExBlockDamage" value="3000"/>
		<display_value name="dExEntityDamage" value="550"/>
		<display_value name="dFuseTime" value="4"/>
		<triggered_effect trigger="onSelfWaterSubmerge" action="ResetHeldItem"/>
	</effect_group>
<!-- add random damage -->
	<effect_group tiered="false">
		<passive_effect name="ExplosionEntityDamage" operation="perc_add" value="-.3,.3" /> 
		<!-- random EntityDmg -->
		<passive_effect name="ExplosionBlockDamage" operation="perc_add" value="-.3,.3" /> 
		<!-- random BlockDmg -->
	</effect_group>	
</item>
</append>

</if>
</conditional>

</RamblingMan>